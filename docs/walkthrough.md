# ⚡ V8 하이브리드 자동화 시스템 사용 설명서 (Walkthrough)

본 문서는 최신 버전인 **V8 자동화 시스템**의 주요 기능과 사용 방법을 안내합니다. V8은 사용자의 개입을 최소화하고 업무 처리 속도를 극대화하는 것에 초점을 맞추어 개발되었습니다.

---

## 🌟 V8의 3대 핵심 변화

1.  **로그인 과정 생략 (Login-Free)**
    *   사용자가 이미 로그인하여 사용 중인 브라우저 세션을 그대로 활용합니다. 불필요한 로그인 대기 시간이 사라졌습니다.
2.  **작업 후 즉시 자동 종료**
    *   이카운트 '웹자료올리기' 팝업에 데이터를 붙여넣은 즉시 브라우저 제어권을 사용자에게 돌려주고 스크립트를 종료합니다. 사용자는 바로 `F8(저장)`을 눌러 저장을 완료할 수 있습니다.
3.  **실시간 상태 알림 대시보드**
    *   웹 UI를 통해 자동 다운로드가 언제 실행되었는지, 현재 어떤 파일이 업로드 중인지 실시간 로그를 확인할 수 있습니다.

---

## 🚀 사용 방법 (Step-by-Step)

### 1단계: 서버 실행
`run_v8_server.bat` 파일을 실행합니다. (또는 바탕화면에 생성된 실행 아이콘 클릭)
*   **포트**: `http://localhost:5080`에서 제어 화면에 접속할 수 있습니다.
*   서버가 시작되면 **Auto-Downloader**가 즉시 활성화되어 30분 간격으로 새 주문을 감시합니다.

### 2단계: 신규 주문 수집 (자동)
*   프로그램은 영림 사이트를 백그라운드에서 감시하며 새로운 발주서를 `data/downloads/` 폴더에 자동으로 저장합니다.
*   이미 다운로드된 파일은 중복해서 받지 않습니다.

### 3단계: ERP 업로드 실행
웹 화면에서 아래 버튼 중 하나를 클릭합니다:
*   **[Upload Ledger (구매입력)]**: 다운로드된 원장 데이터를 이카운트 구매입력 메뉴에 업로드합니다.
*   **[Upload Estimate (견적서입력)]**: 견적서 데이터를 전용 레이아웃(22열)으로 변환하여 견적서입력 메뉴에 업로드합니다.

### 4단계: 최종 저장 (수동)
*   데이터 붙여넣기가 완료되면 `v8_auto_server.py`는 로그에 "Done"을 표시하고 브라우저 제어를 멈춥니다.
*   이때 사용자는 ERP 화면에서 데이터가 잘 들어갔는지 육안으로 확인한 뒤, 키보드의 **F8** 키를 눌러 저장을 완료합니다.

---

## 📂 주요 파일 구조

*   `v8_auto_server.py`: 메인 제어 서버 및 UI 제공
*   `local_file_processor.py`: 발주서 파일 분석 및 데이터 변환 엔진
*   `erp_upload_automation_v1.py`: 이카운트 조작 및 붙여넣기 로직
*   `v8_history.json`: 중복 업로드 방지를 위한 성공 이력 저장소

---

## 💡 팁 및 주의사항

> [!TIP]
> **브라우저가 열리지 않는 경우**: 작업 표시줄에 이미 아바스트 브라우저(Avast Browser)가 실행 중인지 확인하세요. V8은 기존 세션을 공유하므로 브라우저를 닫지 않고 사용하는 것이 더 빠릅니다.

> [!IMPORTANT]
> **상태 초기화**: 만약 업로더가 'Running' 상태에서 멈춰있다면, 웹 화면 하단의 **[Reset Server Status]** 버튼을 클릭하여 강제로 초기화할 수 있습니다.

---
**최종 업데이트**: 2025-12-24
