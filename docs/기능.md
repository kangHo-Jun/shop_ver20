# 영림발주서 자동화 시스템 (V5) 주요 기능 명세

`run_v5_server.bat` (또는 `ㅊㅊㅊㅊㅊㅊ`) 실행 시 구동되는 V5 하이브리드 서버의 전체 기능 목록입니다.

## 1. 시스템 핵심 구성 요소
본 시스템은 세 가지 핵심 모듈이 상호작용하여 전체 자동화를 실현합니다:
- **메인 제어 서버 (`v5_auto_server.py`)**: 웹 기반 사용자 인터페이스(UI) 제공 및 스케줄링 제어
- **파일 분석 엔진 (`local_file_processor.py`)**: 다운로드된 주문서(HTML)를 ERP 규격에 맞게 해석 및 변환
- **ERP 자동 업로더 (`erp_upload_automation_v1.py`)**: 이카운트(Ecount) ERP 접속 및 데이터 일괄 입력

---

## 2. 주요 기능 상세

### 🚀 웹 컨트롤 패널 (Web UI)
- **실시간 모니터링**: 자동 다운로더 및 업로더의 현재 상태(Idle, Running, Waiting) 표시
- **원클릭 제어**: 복잡한 명령 없이 버튼 클릭만으로 자동화 작업 시작 및 중단
- **작업 통계**: 현재까지 처리된 주문 건수(History Count) 및 마지막 실행 시간 확인

### 📥 스마트 자동 다운로더 (Auto-Downloader)
- **백그라운드 감시**: 30분 간격으로 영림 사이트(door.yl.co.kr)를 자동으로 확인
- **자동 로그인 및 내비게이션**: 아바스트 브라우저를 사용하여 세션 유지 및 주문 목록 페이지 자동 접속
- **지능형 파일 저장**: 새로운 주문을 발견하면 날짜별 폴더(`data/downloads/YYYY-MM-DD/`)에 HTML 소스 자동 저장
- **중복 방지**: 이미 다운로드된 파일은 건너뛰어 시스템 자원 낭비 최소화

### 🔍 고성능 데이터 파싱 (Local File Processor)
- **HTML/MHTML 완벽 지원**: 다양한 형식의 주문서 파일을 정확하게 해석
- **회사 키워드 자동 감지**: 영림, 우딘, 예림 등 주문서 공급사 자동 식별
- **지능형 품목 코드 생성**:
    - 문틀(FRAME), 문짝(DOOR), 레일(RAIL), 몰딩(MOLDING) 등 품목별 맞춤 코드 생성 로직 적용
    - 색상, 품명, 규격, 비고 데이터의 특징을 추출하여 ERP 입력용 코드 및 품명 조합 도출
- **규격 자동 해석**: 복잡한 규격 텍스트에서 수치 및 옵션(식기 유/무 등) 자동 추출

### ⬆️ 일괄 ERP 업로드 (Manual Batch Upload)
- **한 번에 처리**: 다운로드된 여러 개의 주문서 데이터를 하나의 엑셀 양식으로 통합하여 일괄 업로드
- **이카운트 자동 조작**:
    - 이카운트 ERP 자동 로그인 및 '구매입력' 메뉴 이동
    - '웹자료올리기' 팝업을 열고 가공된 데이터를 클립보드를 통해 한 번에 입력
- **중복 업로드 원천 차단**: `v4_history.json` 파일을 사용하여 이미 업로드 완료된 주문은 절대 중복 처리하지 않음

---

## 3. 고급 기능 및 안전 장치
- **브라우저 분리**: 사용자의 기본 브라우저와 간섭 없는 전용 브라우저 세션(`avast_automation_profile`) 사용
- **로그 및 이력 관리**: 모든 작업 과정이 로그 파일(`logs/`)에 기록되어 문제 발생 시 추적 가능
- **하이브리드 모드**: 자동 감시는 컴퓨터가, 최종 업로드 결정은 사용자가 하는 최적의 워크플로우 제공
