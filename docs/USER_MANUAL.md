# 매장자동화 V3 - 사용자 매뉴얼

## 📌 개요

이 시스템은 영림/제일 발주서 HTML 파일을 자동으로 분석하여 Ecount ERP에 데이터를 입력합니다.

---

## 🔧 사전 준비

### 필요 사항
- Windows PC
- Python 3.x 설치됨
- Chrome 브라우저 설치됨
- Ecount ERP 계정

### 폴더 위치
| 폴더 | 경로 | 설명 |
|---|---|---|
| **원본 폴더** | `C:\Users\DSAI\Desktop\원본` | 처리할 파일을 넣는 곳 |
| **완료 폴더** | `C:\Users\DSAI\Desktop\원본\완료` | 처리 완료된 파일이 이동되는 곳 |

---

## 📋 사용 방법

### 1단계: 파일 준비
1. 영림/제일 발주서 웹페이지를 엽니다.
2. `Ctrl + S`로 페이지를 저장합니다. (MHTML 형식 권장)
3. 저장된 `.mhtml` 또는 `.html` 파일을 **원본 폴더**에 넣습니다.

### 2단계: 자동화 실행
PowerShell 또는 명령 프롬프트에서:
```powershell
cd C:\Users\DSAI\Desktop\매장자동화
.\.venv\Scripts\python.exe v3_run_all.py
```

### 3단계: 결과 확인
1. Chrome 브라우저가 자동으로 열립니다.
2. Ecount 로그인 후 '웹자료올리기' 팝업에 데이터가 입력됩니다.
3. **데이터를 확인한 후 저장(F8)을 누르세요.**
4. 원본 파일은 자동으로 **완료 폴더**로 이동됩니다.

---

## ⚠️ 주의사항

1. **파일 형식**: `.html`, `.mhtml`, `.mht` 확장자만 인식됩니다.
2. **중복 방지**: 처리된 파일은 자동으로 완료 폴더로 이동되므로 중복 처리가 되지 않습니다.
3. **브라우저 유지**: 스크립트 종료 후에도 Chrome 창은 열린 상태로 유지됩니다.

---

## 🚀 V4 시스템 (Direct Automation) - 추천

V4 시스템은 파일 다운로드 없이 **웹에서 바로 ERP로** 데이터를 전송합니다.

### 특징
- **파일 다운로드 불필요**: 메모리에서 즉시 처리
- **중복 방지**: `v4_history.json`에 처리 내역 자동 저장 (이미 처리된 건은 스킵)
- **속도 향상**: 전체 과정 완전 자동화

### 실행 방법 1: 1회 실행 (즉시 처리)
가장 간편한 방법입니다. 실행 즉시 Door 사이트 조회 -> 신규 건 업로드 -> 종료합니다.

```powershell
.\.venv\Scripts\python.exe run_v4_once.py
```

### 실행 방법 2: 서버 모드 (상시 대기)
백그라운드에 서버를 켜두고 원할 때마다 실행시킬 수 있습니다.

1. **서버 시작**: `run_v4_server.bat` 실행 (창이 열려 있어야 함)
2. **작업 트리거**: 웹 브라우저에서 `http://localhost:5000/trigger` 접속
3. **결과 확인**: 서버 창 로그 확인

---

## 🔍 문제 해결

| 증상 | 해결 방법 |
|---|---|
| "처리할 파일이 없습니다" | 원본 폴더에 HTML/MHTML 파일이 있는지 확인 |
| 로그인 실패 | `erp_upload_automation_v1.py`의 CREDENTIALS 확인 |
| 브라우저가 열리지 않음 | Chrome이 설치되어 있는지, 경로가 올바른지 확인 |

---

## 📞 지원

문제 발생 시 로그 파일 확인:
```
C:\Users\DSAI\ecount_automation\logs\
```
